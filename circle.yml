machine:
  pre:
    - sudo apt-add-repository -y ppa:ubuntu-lxc/daily
    - sudo apt-get update
    - sudo apt-get install libseccomp-dev libseccomp2
    - mkdir -p ~/rust
    - curl -sL https://static.rust-lang.org/dist/rust-nightly-x86_64-unknown-linux-gnu.tar.gz | tar --strip-components=1 -C ~/rust -xzf -
    - curl -sL https://static.rust-lang.org/cargo-dist/cargo-nightly-x86_64-unknown-linux-gnu.tar.gz | tar --strip-components=1 -C ~/rust -xzf -
  environment:
    PATH: ~/rust/rustc/bin/:~/rust/cargo/bin/:$PATH
    LD_LIBRARY_PATH: ~/rust/rustc/lib/:~/rust/cargo/lib/:$LD_LIBRARY_PATH
    RUST_TEST_TASKS: 1
test:
  override:
    - cargo test
